!function(e){var t,s,a,n,o=localStorage.getItem("redirect_uri"),i=window.location.href.split("/"),r=i[0]+"//"+i[2];function c(){if(200==this.status){var t,s=JSON.parse(this.responseText);e.ajaxSetup({headers:{"X-CSRF-TOKEN":e('meta[name="csrf-token"]').attr("content")}}),console.log(s),t=s.images.length>0?s.images[0].url:"def",e.ajax({url:r+"/signup",data:{firstname:s.display_name,email:s.email,role:"curator",img:t,spotifyId:s.id},type:"post",success:function(e){localStorage.clear(),window.location.replace(encodeURI(o))},error:function(e){loader(),alert("Selection Failed. Please try again!")}})}else 401==this.status||(console.log(this.responseText),alert(this.responseText))}let l,p,u,d;window.location.search.length>0&&(s=(u=null,d=window.location.search,d.length>0&&(u=new URLSearchParams(d).get("code")),u),l="grant_type=authorization_code",l+="&code="+s,t=l+="&redirect_uri="+encodeURI(o),(p=new XMLHttpRequest).open("POST","https://accounts.spotify.com/api/token",!0),p.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),p.setRequestHeader("Authorization","Basic OWIxNDA0MjA3ZDVjNDY5OWEzNjkyYzAzNGI1MTJiNjg6MjdkZGY1YTk5NzQwNGI4ZWFkNjA4N2E5NmE1YTk4NDc="),p.send(t),p.onload=function e(){if(200==this.status){var t,s=JSON.parse(this.responseText),o="GET",i="https://api.spotify.com/v1/me",r=null;let l;void 0!=s.access_token&&(a=s.access_token,t=c,(l=new XMLHttpRequest).open("GET",i,!0),l.setRequestHeader("Content-Type","application/json"),l.setRequestHeader("Authorization","Bearer "+a),l.send(null),l.onload=t),void 0!=s.refresh_token&&(n=s.refresh_token)}}),setTimeout(function(){e("#preload").css("display","none"),e("#alert").css("display","")},10200)}(window.jQuery);